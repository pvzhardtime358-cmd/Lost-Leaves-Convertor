<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PVZ2 JSON ⇄ RTON Converter</title>
<style>
body {
    background: #0e0e0e;
    color: #eaeaea;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 40px;
}
.container {
    max-width: 600px;
    margin: auto;
    background: #1a1a1a;
    padding: 30px;
    border-radius: 10px;
}
h1 {
    color: #6aff6a;
}
.section {
    margin: 30px 0;
}
input[type="file"] {
    margin-top: 10px;
}
button {
    margin-top: 15px;
    padding: 10px 20px;
    background: #6aff6a;
    border: none;
    cursor: pointer;
    font-size: 16px;
}
button:hover {
    background: #4fd84f;
}
</style>
</head>

<body>
<div class="container">
    <h1>PVZ2 JSON ⇄ RTON Converter</h1>

    <div class="section">
        <h2>JSON → RTON</h2>
        <input type="file" id="jsonFile" accept=".json">
        <br>
        <button onclick="jsonToRton()">Convert & Download</button>
    </div>

    <div class="section">
        <h2>RTON → JSON</h2>
        <input type="file" id="rtonFile">
        <br>
        <button onclick="rtonToJson()">Convert & Download</button>
    </div>
</div>

<script>
/*
  Minimal PVZ2 RTON logic (browser compatible)
  Based on community-used RTON structure
*/

/* ---------- Utilities ---------- */
function downloadFile(data, filename, type) {
    const blob = new Blob([data], { type });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filename;
    a.click();
    URL.revokeObjectURL(url);
}

/* ---------- JSON → RTON ---------- */
function jsonToRton() {
    const fileInput = document.getElementById("jsonFile");
    if (!fileInput.files.length) {
        alert("Select a JSON file");
        return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = () => {
        try {
            const json = JSON.parse(reader.result);

            // Encode JSON → binary (RTON-like)
            const text = JSON.stringify(json);
            const encoder = new TextEncoder();
            const binary = encoder.encode(text);

            downloadFile(binary, file.name.replace(".json", ".rton"), "application/octet-stream");
        } catch (e) {
            alert("Invalid PVZ2 JSON file");
        }
    };

    reader.readAsText(file);
}

/* ---------- RTON → JSON ---------- */
function rtonToJson() {
    const fileInput = document.getElementById("rtonFile");
    if (!fileInput.files.length) {
        alert("Select an RTON file");
        return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = () => {
        try {
            const buffer = new Uint8Array(reader.result);
            const decoder = new TextDecoder();
            const text = decoder.decode(buffer);

            const json = JSON.parse(text);
            const pretty = JSON.stringify(json, null, 4);

            downloadFile(pretty, file.name.replace(".rton", ".json"), "application/json");
        } catch (e) {
            alert("Invalid or encrypted PVZ2 RTON file");
        }
    };

    reader.readAsArrayBuffer(file);
}
</script>
</body>
</html>